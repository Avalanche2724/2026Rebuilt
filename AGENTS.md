Build: ./gradlew build
For any Gradle action, use WPILib JDK: `JAVA_HOME=~/wpilib/2026/jdk`
All commit messages generated by Codex must start with `(codex)`.
Do not create a new git branch when committing unless explicitly requested.

Code Guidelines
- Keep the code organized (clear package structure; avoid dumping logic into `Robot`).
- Project convention: do not create per-subsystem packages (keep subsystems under `frc.robot.subsystems` unless explicitly directed otherwise).
- Prefer including units in variable/method parameter names for raw numbers (examples: `speedRps`, `voltageVolts`, `dtSeconds`, `positionRot`).
- Subsystem ordering (within a subsystem class/file):
  - `private static final` tuning/reused constants (SCREAMING_SNAKE_CASE, units in names) and other constants that benefit from being easy to scan.
  - Hardware fields + internal state (motors/sensors, sim objects, alerts, cached state). Avoid exposing hardware objects outside the subsystem.
  - Hardware configuration in constructor.
  - Public subsystem APIs / command factories (anything that writes to hardware must either be a private method or a command).
  - `periodic()` / `updateSim()` / other helpers (e.g. conversions, clamps, small utilities).
- Constants:
  - Prefer inlining constants at the site where they are used when the meaning is obvious from context (example: motor configuration fields like `configs.Slot0.kP = 0.5;`).
  - Use named constants only for values that are likely to change often during tuning or that are reused across multiple call sites (examples: motor/controller IDs, gear ratios, mechanism position/velocity setpoints).
  - Values unlikely to change often (example: simulation moment of inertia) may be inlined with a short explanatory comment if the meaning is not immediately obvious.
  - Keep constants in the same file where they are used; do not create separate `*Constants` classes/files unless explicitly directed otherwise.
- Doubles: if a value is a `double`, write it with a decimal point (`1.0`, not `1`).
- Constants at top of file with `SCREAMING_SNAKE_CASE`.
- Avoid magic numbers; use named constants (include units in names, e.g. `MAX_VELOCITY_MPS`); avoid manual unit conversions, use WPILib units (e.g. `RotationsPerSecond.convertFrom(value, RadiansPerSecond)`) and static import any WPILib units used.
- Prefer immutable where reasonable (`final` fields ok); do not mark locals `final`; for non-primitive locals prefer `var`; minimize global/static state.
- Keep robot loop code non-blocking (no `Thread.sleep`, no long I/O in `periodic`/command `execute`).
- Prefer command factory methods (e.g. `Commands.*`) over explicit command classes.
- Avoid allocating new motor control request objects inside command lambdas (e.g. `new VoltageOut(...)`, `new VelocityVoltage(...)` in a command’s execute loop). Cache request objects as fields and use `with...(...)` to update setpoints.
- Phoenix 6 status signals: cache `StatusSignal` fields you care about (e.g. velocity/current), and call `BaseStatusSignal.refreshAll(...)` in `periodic()` before reading/using their values.
- Phoenix 6 configs: apply configs via a shared “apply with retry + status check” utility (avoid copy/pasting `getConfigurator().apply(...)` without checking status).
- For persistent errors/warnings (e.g. a motor config failing to apply), prefer WPILib `Alert` so it shows up reliably on dashboards.
- Motor subsystems should generally have a default command that sets a safe neutral output (coast/0V), so the mechanism doesn’t “latch” the last output when nothing is scheduled.
- Simulation: keep sim stepping centralized (e.g. `RobotContainer`), but subsystems should still set `TalonFXSimState` orientation and motor type when in simulation.
- Comments should explain "why" and constraints; avoid narrating obvious code.
- Build before commit: `./gradlew build` (build runs formatting via Spotless).

Sources (vendor + WPILib)
- Use WPILib JDK to avoid Gradle errors: `JAVA_HOME=~/wpilib/2026/jdk`.
- Download all Java sources jars with Gradle: `./gradlew downloadSources`.
- Unpack sources into `build/sources/` for fast searching: `./gradlew syncSources`.
- Vendordep definitions live in `vendordeps/*.json` (Maven URLs + artifacts).
- Prefer inspecting sources via `build/sources/` (run `./gradlew syncSources` first), then use `rg -n` to search.

Search tips
- Prefer `rg -n` / `rg --files` over `find` for code lookups.
- If you do use `find`, avoid shallow `-maxdepth` (it’s easy to miss deeply nested vendor sources), and be careful with `-o` precedence; use parentheses like `find ... \\( -name 'A' -o -name 'B' \\)` so results are what you expect.
